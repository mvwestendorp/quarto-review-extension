/**
 * Component: Comments Sidebar (positioned below main review tools)
 */

.review-comments-sidebar {
  position: fixed !important;
  top: calc(80px + 400px); /* Below main sidebar (80px + max-height of main) */
  left: auto;
  right: clamp(16px, 2vw, 24px);
  z-index: calc(var(--review-z-toolbar) - 2);
  backdrop-filter: blur(8px);
  width: 280px;
  background: rgba(255, 255, 255, 0.95);
  border: 1px solid rgba(var(--review-color-primary-rgb), 0.1);
  border-top: none; /* Connects to main sidebar above */
  border-radius: 0 0 16px 16px; /* Only bottom corners rounded */
  box-shadow: var(--review-shadow-xl);
  max-height: calc(100vh - 80px - 400px - 24px); /* Remaining viewport height */
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

body.review-sidebar-collapsed-mode .review-comments-sidebar {
  right: clamp(16px, 2vw, 24px);
}

.review-comments-sidebar .review-sidebar-body {
  display: flex;
  flex-direction: column;
  gap: 20px;
  padding-bottom: 18px;
}

.review-comments-sidebar-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 18px;
  overflow-y: auto;
  min-height: 0;
}

.review-comments-empty {
  text-align: center;
  padding: 32px 18px;
  color: var(--review-color-neutral-mid);
  background: rgba(248, 250, 252, 0.85);
  border: 1px dashed rgba(148, 163, 184, 0.45);
  border-radius: 12px;
  font-size: 14px;
}

.review-comments-empty p {
  margin: 6px 0;
}

/* Hide comments sidebar when main sidebar is collapsed */
.review-comments-sidebar.review-sidebar-collapsed {
  display: none; /* Completely hide when collapsed */
}

body.review-sidebar-collapsed-mode .review-comments-sidebar {
  display: none; /* Hide in collapsed mode */
}

.review-comments-sidebar.review-sidebar-collapsed .review-sidebar-body {
  display: none;
}

.review-comments-sidebar.review-sidebar-collapsed .review-sidebar-header {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  flex: 1;
  padding: 8px 4px;
  background: transparent;
  border-bottom: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  min-height: 100%;
}

.review-comments-sidebar.review-sidebar-collapsed .review-sidebar-header h3 {
  display: none;
}

.review-comments-sidebar.review-sidebar-collapsed
  .review-sidebar-header
  .review-btn-icon {
  width: 38px;
  height: 38px;
  border-radius: 999px;
  background: rgba(var(--review-color-primary-rgb), 0.12);
  box-shadow: var(--review-shadow-sm);
  color: var(--review-color-primary);
}

.review-comments-sidebar.review-sidebar-collapsed
  .review-sidebar-header
  .review-btn-icon:hover {
  background-color: rgba(var(--review-color-primary-rgb), 0.18);
  color: var(--review-color-primary-darker);
  transform: scale(1.05);
}

.review-comments-sidebar.review-sidebar-collapsed
  .review-sidebar-header
  .review-btn-icon:active {
  transform: scale(0.95);
}

.review-comments-sidebar.review-sidebar-collapsed .review-icon-chevron,
body.review-sidebar-collapsed-mode .review-comments-sidebar .review-icon-chevron {
  transform: rotate(180deg);
}

.review-comments-sidebar:not(.review-sidebar-collapsed) .review-icon-chevron {
  transform: rotate(0deg);
}

body.review-comments-sidebar-open {
  padding-inline-end: clamp(0px, 14vw, 360px);
}

body.review-comments-sidebar-open.review-sidebar-collapsed-mode {
  padding-inline-end: clamp(0px, 12vw, 320px);
}

@media (max-width: 980px) {
  body.review-comments-sidebar-open {
    padding-inline-end: clamp(0px, 18vw, 320px);
  }
}

@media (max-width: 640px) {
  .review-comments-sidebar {
    width: 100%;
    left: 0;
    right: 0;
    top: auto;
    bottom: 16px;
    max-width: 360px;
    margin: 0 auto;
  }

  body.review-comments-sidebar-open {
    padding-inline-end: clamp(0px, 12vw, 300px);
  }
}
